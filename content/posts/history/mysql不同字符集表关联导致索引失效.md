---
title: "Mysql不同字符集表关联导致索引失效"
date: 2022-01-06 11:25:45.783000
draft: false
bookComments: true
tags: ["2023-05-07从halo博客迁移"]
# bookSearchExclude: false
---
背景：
在做业务初始化时，出现join表关联没有走索引的情况，原来只要执行半个小时的脚本，现在要执行几个小时，经排查，是两个表的字符集不一样，旧表的字符集是utf8，而新表的字符集都是utf8mb4，而导致关联时不走索引。

目前解决方案有两种：
1、修改旧表字符集成utf8mb4
2、在执行脚本时，转换字符集类型，从而让其走索引
`convert(字段 using utf8mb4)`

1方案要处理难度非一般，目前业务在线上跑，

